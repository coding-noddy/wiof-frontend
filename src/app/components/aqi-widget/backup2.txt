<ion-card>
  <ion-card-header class="wiof-aqi-widget-card-header">
    <ion-card-title>
      AQI Widget
    </ion-card-title>
    </ion-card-header>
      <ion-toolbar class="wiof-aqi-widget-card-toolbar">
        <ion-button fill="outline" slot="start" (click)="loadMajorCitiesDiv()">Major Cities</ion-button>
        <ion-button fill="outline" slot="start" (click)="loadSearchCityDiv()">Search City</ion-button>
        <!-- future use new window aqi map view button -->
        <!-- <ion-button ><ion-icon name="browsers-outline"></ion-icon></ion-button> -->
      </ion-toolbar>
      <ion-card-content>
        <div *ngIf="widgetMajorCities">
          <ion-row>
            <ion-col size="4">Location</ion-col>
            <ion-col size="8">AQI</ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="4">Delhi</ion-col>
            <ion-col size="8">
              <p *ngIf="(aqiDelhi|async) as aqiDelhiData;else loadingDelhi" [ngClass]="aqiColor(aqiDelhiData.data.aqi)"> {{aqiDelhiData.data.aqi}} with {{aqiDelhiData.data.dominentpol | uppercase}} as the responsible pollutant.</p>               
                <ng-template #loadingDelhi>
                  <ion-spinner name="crescent" class="wiof-spinner"></ion-spinner><br />
                </ng-template> 
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="4">Kolkata</ion-col>
            <ion-col size="8">
              <p *ngIf="(aqiKolkata|async) as aqiKolkataData;else loadingKolkata" [ngClass]="aqiColor(aqiKolkataData.data.aqi)"> {{aqiKolkataData.data.aqi}} with {{aqiKolkataData.data.dominentpol | uppercase}} as the responsible pollutant.</p>               
                <ng-template #loadingKolkata>
                  <ion-spinner name="crescent" class="wiof-spinner"></ion-spinner><br />
                </ng-template> 
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="4">Bangalore</ion-col>
            <ion-col size="8">
              <p *ngIf="(aqiBangalore|async) as aqiBangaloreData;else loadingBangalore" [ngClass]="aqiColor(aqiBangaloreData.data.aqi)" > {{aqiBangaloreData.data.aqi}} with {{aqiBangaloreData.data.dominentpol | uppercase}} as the responsible pollutant.</p>               
                <ng-template #loadingBangalore>
                  <ion-spinner name="crescent" class="wiof-spinner"></ion-spinner><br />
                </ng-template> 
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="4">Mumbai</ion-col>
            <ion-col size="8">
              <p *ngIf="(aqiMumbai|async) as aqiMumbaiData;else loadingMumbai" [ngClass]="aqiColor(aqiMumbaiData.data.aqi)" > {{aqiMumbaiData.data.aqi}} with {{aqiMumbaiData.data.dominentpol | uppercase}} as the responsible pollutant.</p>               
                <ng-template #loadingMumbai>
                  <ion-spinner name="crescent" class="wiof-spinner"></ion-spinner><br />
                </ng-template> 
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="4">Chennai</ion-col>
            <ion-col size="8">
              <p *ngIf="(aqiChennai|async) as aqiChennaiData;else loadingChennai" [ngClass]="aqiColor(aqiChennaiData.data.aqi)" > {{aqiChennaiData.data.aqi}} with {{aqiChennaiData.data.dominentpol | uppercase}} as the responsible pollutant.</p>               
                <ng-template #loadingChennai>
                  <ion-spinner name="crescent" class="wiof-spinner"></ion-spinner><br />
                </ng-template> 
            </ion-col>        
          </ion-row>                              
          <ion-label>Global AQI Data Credit: </ion-label>
          <ion-text>World Air Quality Index Project</ion-text>
        </div>
        <div *ngIf="widgetSearchCity">
          Search Location
          <ion-item>
            <ion-label position="floating">Enter Location</ion-label>
            <ion-input [(ngModel)]="location"></ion-input>
          </ion-item>
            <ion-button (click)="loadCityAqiData()">Search</ion-button>
          
          <div *ngIf="searchClickFlag">
            <div scrollY="true"  class="wiof-aqi-widget-items">
              <div *ngIf="(searchCityAqi|async) as locationsfound;else loading">
                  <!-- <p> {{locationsfound.data|json}} </p> -->
                  <ion-row>
                    <ion-col size-xs="10">
                      <p><strong>Station Name (Click on location for AQI details)</strong></p>
                    </ion-col>
                    <ion-col size-xs="2">
                      <p style="text-align: center;"><strong>AQI</strong></p>                      
                    </ion-col>
                  </ion-row>   
                  <div *ngFor="let location of locationsfound.data">
                    <ion-row>
                      <ion-col size-xs="10">
                        <p class="wiof-aqi-search-result-expand" (click)="expandLocationAqiDetails(location.station.url)" >
                          <!-- (click)=expandLocationAqiDetails({{location.station.url}}) -->                        
                          {{location.station.name}}                          
                        </p>
                      </ion-col>
                      <ion-col size-xs="2">
                        <p style="text-align: center;" [ngClass]="aqiColor(location.aqi)">{{location.aqi}}</p>                      
                      </ion-col>
                    </ion-row>                  
                  </div>
              </div>
            </div>

            <div  *ngIf="searchAqiData.status==='ok';else notFound">
              <ion-label>AQI: </ion-label>
              <ion-text> {{searchAqiData.data.aqi}}</ion-text>
              <br>
              <ion-label>Dominent pollutant: </ion-label>
              <ion-text> {{searchAqiData.data.dominentpol | uppercase}}</ion-text>
              <br>
              <ion-label>Station Name: </ion-label>
              <ion-text > {{searchAqiData.data.city.name}}</ion-text>
              <br>
              
              <div *ngIf="searchAqiData.data.iaqi.dew">
              <ion-label>Dew: </ion-label>
              <ion-text> {{searchAqiData.data.iaqi.dew.v}}</ion-text>
              <br>
              </div>

              <div *ngIf="searchAqiData.data.iaqi.h">
              <ion-label>Humidity: </ion-label>
              <ion-text> {{searchAqiData.data.iaqi.h.v}}</ion-text>
              <br>
            </div>

            <div *ngIf="searchAqiData.data.iaqi.p">
              <ion-label>Pressure: </ion-label>
              <ion-text> {{searchAqiData.data.iaqi.p.v}}</ion-text>
              <br>
            </div>

            <div *ngIf="searchAqiData.data.iaqi.pm25">
              <ion-label>PM25: </ion-label>
              <ion-text> {{searchAqiData.data.iaqi.pm25.v}}</ion-text>
              <br>
            </div>

            <div *ngIf="searchAqiData.data.iaqi.t">
              <ion-label>Temperature: </ion-label>
              <ion-text> {{searchAqiData.data.iaqi.t.v}}</ion-text>
              <br>
            </div>

            <div *ngIf="searchAqiData.data.iaqi.w">
              <ion-label>Wind: </ion-label>
              <ion-text> {{searchAqiData.data.iaqi.w.v}}</ion-text>
              <br>
            </div>

              <ion-label>Global AQI Data Credit: </ion-label>
              <ion-text>World Air Quality Index Project</ion-text>
              
              <br>

              <ion-label>Dew: </ion-label>
              <ion-text> {{searchAqiData.iaqi.wg.v}}</ion-text>
              </div>
            <ng-template #loading>
              <ion-spinner name="crescent" class="wiof-spinner" ></ion-spinner><br />
            </ng-template> 
            <ng-template #notFound>
              <p>Sorry, data not available for provided location.</p>
            </ng-template> 
          </div>
        </div>
        <br>
        <!-- new scorecard implementation -->

        <!-- <app-aqi-scorecard [locationUrl]="locationDetails"></app-aqi-scorecard> -->
        
  </ion-card-content>
</ion-card>